The code can be run by firstly running the second cell in order to define the environment, then run the eighth cell (last one).
